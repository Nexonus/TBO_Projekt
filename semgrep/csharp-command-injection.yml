rules:
  - id: csharp-command-injection-processstartinfo
    languages: [csharp]
    severity: ERROR
    message: >
      Possible command injection: user-controlled input flows into
      ProcessStartInfo.Arguments and is executed by a shell.
    mode: taint

    pattern-sources:
      - pattern: |
          IActionResult $M(..., string $X, ...)

    pattern-sinks:
      - pattern: |
          Arguments = $ARGS

    pattern-propagators:
      - pattern: |
          $A ? $B : $C
        from: $B
        to: $A
      - pattern: |
          $A ? $B : $C
        from: $C
        to: $A
